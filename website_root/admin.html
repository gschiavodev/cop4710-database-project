<?php
    
    session_start();

    // Check if user is logged in
    if (isset($_SESSION['username'])) 
    {

        $servername = "mysql";
        $username = "webserver";
        $password = "X7g9#4vZ1$2cQ5";
        $database = "college_events";

        // Create connection
        $conn = mysqli_connect($servername, $username, $password, $database);

        // Check connection
        if (!$conn) 
        {
            die("Connection failed: " . mysqli_connect_error());
        }

        // The form was submitted, let's try to log the user in
        // Assuming $conn is your MySQLi connection
        $username = $_POST['username'];
        $password = $_POST['password'];

        // Prepare a SELECT statement to get the user with the provided username
        $statement = $conn->prepare("SELECT * FROM super_admin WHERE id = ? UNION SELECT * FROM admin WHERE id = ?");
        $statement->bind_param("ii", $_SESSION['user_id'], $_SESSION['user_id']);
        $statement->execute();

        $result = $statement->get_result();

        if ($result->num_rows != 0) 
        {

            // The user is an admin, set session variable
            $_SESSION['is_admin'] = true;

        }
        else
        {

            // The user is not an admin, set session variable
            $_SESSION['is_admin'] = false;

        }

    }

?>

<!DOCTYPE html>

<html>

    <head>
        <title>College Event Website</title>
        <link rel="stylesheet" type="text/css" href="css/common_styles.css">
    </head>

    <body>
        
        <header>
            <nav>
                <ul>

                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html">Events</a></li>
                    <li><a href="index.html">RSOs</a></li>

                </ul>
                <ul>

                    <?php if ($_SESSION['is_admin']) :?>

                        <!-- This content will only be shown if the user is an admin -->
                        <li><a href="admin.html">Admin</a></li>
                        
                    <?php endif; ?>

                    <!-- This content will only be shown if the user is logged in -->
                    <li><a href="index.html?logout=true">Logout</a></li>

                </ul>
            </nav>
        </header>

        <main>

            <div class="row">

                <section class="section">
                    <h1>Admin</h1>
                </section>
                
            </div>

        </main>

        <footer>
            <p>&copy; Gabriel Schiavo</p>
        </footer>
        
    </body>
</html>